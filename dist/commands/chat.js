// Generated by CoffeeScript 2.5.1
module.exports.run = async function(client, message, args) {
  var guildLanguage, res, userData;
  // Check if there is a message to send
  if (!args[0]) {
    return client.createMessage(message.channel.id, `:x: You must specify something to say to Simsimi!`);
  }
  userData = client.db.get("chatUses").value()[message.author.id] || 0;
  if (userData > client.config.maxRequestPerUser) {
    return client.createMessage(message.channel.id, `:x: Ratelimit exceeded. You can't send messages to simsimi anymore...`);
  }
  // Try to get guild language
  guildLanguage = client.db.get("serversLanguages").value()[message.channel.guild.id];
  // Make the request
  res = (await client.simsimi.request(args.join(" "), guildLanguage));
  if (!res.atext) {
    return message.addReaction("ğŸ˜¢");
  }
  // Reply
  client.createMessage(message.channel.id, `${res.atext}`);
  // Save uses
  return client.db.set(`chatUses.${message.author.id}`, userData + 1).write();
};

module.exports.help = {
  name: "chat",
  onlyMod: false
};
